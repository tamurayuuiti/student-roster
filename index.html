<!DOCTYPE html>
<html lang="ja" data-auth="loading">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3学年名簿</title>

  <!-- Tailwind CSS CDN（レイアウト・余白などのユーティリティ用） -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- フォント（日本語＋英字） -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">

  <!-- プロジェクト固有のスタイル（色・影・認証画面の背景など） -->
  <link rel="stylesheet" href="./auth/auth.css">
  <link rel="stylesheet" href="./styles.css">

  <!-- Firebase 設定（そのまま貼付） -->
  <script id="firebase-config" type="application/json">
    {
      "apiKey": "AIzaSyBtJgxwPf8_ocSct_-P66Jki_UCYbnQG6I",
      "authDomain": "student-roster-8b49a.firebaseapp.com",
      "projectId": "student-roster-8b49a",
      "storageBucket": "student-roster-8b49a.appspot.com",
      "messagingSenderId": "419395010291",
      "appId": "1:419395010291:web:0aaed2f2983d4eadd3c186",
      "measurementId": "G-LXWL4LT3MS"
    }
  </script>
</head>

<body class="bg-gray-100">

  <!-- =========================================================
        認証ゲート（data-auth="signedout" のとき利用）
       ========================================================= -->
  <section id="auth-gate" aria-live="polite" class="min-h-screen flex items-center justify-center p-4 md:p-8">
    <div class="auth-card max-w-md w-full">
      <div class="text-xl font-bold text-slate-900 tracking-tight mb-2 text-center">
        ログイン
      </div>
      <p id="auth-subtitle" class="text-slate-500 text-sm mb-4 text-center">
        このページを利用するには、Googleアカウントでサインインしてください。
      </p>

      <!-- 外側はセンタリング用、内側がJSで display を切り替える要素 -->
      <div class="flex justify-center">
        <div id="auth-signedout" style="display:none; gap:.6rem; margin:0.8rem 0 0.8rem;">
          <button
            id="auth-login-popup"
            class="gsi-material-button"
            type="button"
            aria-label="Sign in with Google"
            style="width:260px;">
            <div class="gsi-material-button-state"></div>
            <div class="gsi-material-button-content-wrapper">
              <div class="gsi-material-button-icon" aria-hidden="true">
                <!-- Google "G" ロゴ（公式配布SVGと同形状・改変なし。削除・書き換え注意） -->
                <svg xmlns="http://www.w3.org/2000/svg"
                     viewBox="0 0 48 48"
                     style="display:block;">
                  <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path>
                  <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path>
                  <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path>
                  <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path>
                  <path fill="none" d="M0 0h48v48H0z"></path>
                </svg>
              </div>
              <span class="gsi-material-button-contents">Sign in with Google</span>
              <span class="gsi-material-button-label">Sign in with Google</span>
            </div>
          </button>
        </div>
      </div>

      <!-- ログイン後（ゲート上でも状態確認＆ログアウト可能） -->
      <div id="auth-signedin" style="display:none; margin-top:.6rem;">
        <div id="auth-data" class="auth-meta mb-2">状態: 認証済み</div>
        <button id="auth-logout" class="auth-logout" style="margin-top:.25rem;">ログアウト</button>
      </div>

      <!-- エラーメッセージ表示域（JSが表示する） -->
      <div id="auth-error" class="text-red-600 text-sm mt-4 text-center font-medium" style="display:none;">
        <!-- JSから動的にメッセージが入る想定 -->
      </div>
    </div>
  </section>

  <!-- =========================================================
       アプリ本体（data-auth="signedin" のとき利用）
       ========================================================= -->
  <div id="app-root">

    <!-- ヘッダー：背景はフル幅 / 中身は中央寄せ -->
    <header class="bg-white shadow-md">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <!-- タイトル -->
          <a href="#" class="text-2xl font-bold text-gray-900 tracking-wide">
            3学年名簿
          </a>

          <!-- プロフィール/メニュー（JSで制御） -->
          <div class="relative">
            <button id="menu-toggle"
                    class="flex items-center space-x-2 p-1 rounded-full hover:bg-gray-100 transition duration-150"
                    aria-expanded="false" aria-controls="user-menu" type="button">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 text-blue-900" viewBox="0 0 24 24" fill="none"
                   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
              </svg>
            </button>

            <!-- ドロップダウンメニュー（初期は非表示／JSがhidden系クラスを操作） -->
            <div id="user-menu"
                 class="dropdown-menu hidden-menu absolute right-0 mt-2 w-64 bg-white border border-gray-200 rounded-xl shadow-xl z-30 opacity-0 pointer-events-none hidden"
                 role="menu" aria-orientation="vertical" aria-labelledby="menu-toggle">
              <div class="p-4 border-b border-gray-100">
                <p id="user-email" class="text-sm font-semibold text-gray-900 truncate">signedin@example.com</p>
              </div>
              <div class="py-2">
                <button id="auth-chip-logout"
                        class="w-full text-left px-4 py-2 text-sm text-red-600 font-medium hover:bg-red-50 hover:text-red-700 transition"
                        type="button">
                  ログアウト
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- コンテンツ：中央寄せコンテナ
         Tailwindでレイアウト・余白、自前CSSでカードの色・影を設定する想定 -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">

      <!-- コントロールパネル（検索・ソート） -->
      <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-4 max-w-7xl mx-auto space-y-4 lg:space-y-0 lg:space-x-6 p-4 bg-white rounded-xl shadow-lg border border-gray-100">
        <!-- 検索フィールド -->
        <div class="w-full lg:w-1/3 relative">
          <input
            type="text"
            id="search-input"
            placeholder="名前、番号、クラスで検索"
            class="w-full p-2 pl-10 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 text-gray-700"
          >
          <!-- 検索アイコン（自前なので差し替え可） -->
          <svg
            class="absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </div>

        <!-- ソート -->
        <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 w-full lg:w-auto justify-end">
          <div class="flex items-center space-x-3 w-full sm:w-auto">
            <label for="sort-criteria" class="text-sm font-medium text-gray-700 whitespace-nowrap">ソート基準:</label>
            <select id="sort-criteria"
                    class="flex-grow p-2 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
              <option value="class">クラス（番号順）</option>
              <option value="reading">氏名（ふりがな順）</option>
            </select>
          </div>

          <button id="sort-direction-toggle"
                  class="flex items-center justify-center p-2 bg-indigo-600 text-white rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition duration-150 w-full sm:w-auto">
            <svg id="sort-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 class="mr-2 transform transition duration-300 rotate-0">
              <path d="m18 15-6-6-6 6"/>
            </svg>
            <span id="sort-label" class="font-semibold">昇順</span>
          </button>
        </div>
      </div>

      <!-- クラスジャンプボタン（JSで挿入／初期はhidden） -->
      <div id="jump-button-container"
           class="mb-6 flex flex-wrap justify-center gap-3 p-4 bg-white rounded-xl shadow-lg border border-gray-100 hidden">
        <!-- JSで挿入 -->
      </div>

      <!-- カードグリッド（JSでカードを生成） -->
      <section id="card-grid"
               class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
        <!-- JSで挿入 -->
      </section>

      <!-- フッター（件数表示） -->
      <footer class="text-center mt-12 text-gray-400 text-sm">
        <p>
          表示中: <span id="member-count">0</span> 名
          <span class="mx-2">|</span>
          全件数: <span id="total-count">0</span> 名
        </p>
      </footer>
    </main>
  </div>

  <!-- =========================================================
        スクリプト群
       ========================================================= -->
  <script type="module" src="./auth/auth.js"></script>
  <script src="./app.js"></script>
</body>
</html>
